package org.datasource.mongodb.views.departamentscities;

import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;
import org.datasource.mongodb.MongoDataSourceConnector;
import org.springframework.stereotype.Service;

import java.util.ArrayList;
import java.util.List;

@Service
public class SalaryViewBuilder {

	// Data cache
	
	private List<SalaryUkraine> salariesViewList;
	
	public List<SalaryUkraine> getSalariesViewList() {
		return salariesViewList;
	}

	//
	private MongoDataSourceConnector dataSourceConnector;
	
	
	public SalaryViewBuilder(MongoDataSourceConnector dataSourceConnector) {
		this.dataSourceConnector = dataSourceConnector;
	}

	// Builder Workflow
	public SalaryViewBuilder build() throws Exception{
		return this.select();
	}
		
	
	public SalaryViewBuilder select() throws Exception {
		MongoDatabase db = dataSourceConnector.getMongoDatabase();

		MongoCollection<SalaryUkraine> salariesCollection =
				db.getCollection("SalariesUkraine", SalaryUkraine.class);
		this.salariesViewList = salariesCollection.find().into(new List<SalaryUkraine>());
		
		return this;
	}
}
